<!doctype html><html>
<head>
<title>HTTP Logging and Go API Template Updates</title>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta http-equiv=x-ua-compatible content="ie=edge">
<link rel=stylesheet href=/css/bootstrap.min.css>
<link rel=stylesheet href=/css/layouts/main.css>
<link rel=stylesheet href=/css/navigators/navbar.css>
<link rel=stylesheet href=/css/plyr.css>
<link rel=stylesheet href=/css/flag-icon.min.css>
<link rel=stylesheet href=/css/katex.min.css>
<link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Muli:wght@300;400;500;600">
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css>
<link rel=icon type=image/png href=/images/author/dan_hu9475e40123017607cf3e014e405fbc8c_9664_42x0_resize_q75_box.jpg>
<meta property="og:title" content="HTTP Logging and Go API Template Updates">
<meta property="og:description" content="HTTP Logging and Go API Template Updates">
<meta property="og:type" content="article">
<meta property="og:url" content="https://gilcrest.github.io/posts/archive/http-logging-and-go-api-template-updates/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2018-10-13T07:10:00-04:00">
<meta property="article:modified_time" content="2018-10-13T07:10:00-04:00">
<meta name=description content="HTTP Logging and Go API Template Updates">
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/atom-one-dark.min.css>
<link rel=stylesheet href=/css/layouts/single.css>
<link rel=stylesheet href=/css/navigators/sidebar.css>
<link rel=stylesheet href=/css/style.css>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-WB0P084V1J"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-WB0P084V1J',{anonymize_ip:!1})}</script>
</head>
<body data-spy=scroll data-target=#TableOfContents data-offset=80>
<div class="container-fluid bg-dimmed wrapper">
<nav class="navbar navbar-expand-xl top-navbar final-navbar shadow">
<div class=container>
<button class="navbar-toggler navbar-light" id=sidebar-toggler type=button onclick=toggleSidebar()>
<span class=navbar-toggler-icon></span>
</button>
<a class=navbar-brand href=/>
<img src=/images/author/dan_hu9475e40123017607cf3e014e405fbc8c_9664_42x0_resize_q75_box.jpg alt=Logo>
Dan Gillis</a>
<button class="navbar-toggler navbar-light" id=toc-toggler type=button onclick=toggleTOC()>
<span class=navbar-toggler-icon></span>
</button>
<div class="collapse navbar-collapse lang-selector" id=top-nav-items>
<ul class="navbar-nav ml-auto">
</ul>
</div>
</div>
<img src=/images/author/dan_hu9475e40123017607cf3e014e405fbc8c_9664_42x0_resize_q75_box.jpg class=d-none id=main-logo alt=Logo>
<img src=/images/author/dan_hu9475e40123017607cf3e014e405fbc8c_9664_42x0_resize_q75_box.jpg class=d-none id=inverted-logo alt="Inverted Logo">
</nav>
<section class=sidebar-section id=sidebar-section>
<div class=sidebar-holder>
<div class=sidebar id=sidebar>
<form class=mx-auto method=get action=/search>
<input type=text name=keyword placeholder=Search data-search id=search-box>
</form>
<div class=sidebar-tree>
<ul class=tree id=tree>
<li id=list-heading><a href=/posts data-filter=all>Posts</a></li>
<div class=subtree>
<li><a href=/posts/logging/ title="Logging in go-api-basic">Logging in go-api-basic</a></li>
<li><a href=/posts/errors/ title="REST API Error Handling in Go">REST API Error Handling in Go</a></li>
<li><a href=/posts/gopherhole/ title="Emerging from my Gopher Hole">Emerging from my Gopher Hole</a></li>
<li><a href=/posts/conversion/ title="Jekyll to Hugo Conversion">Jekyll to Hugo Conversion</a></li>
<li>
<i class="fas fa-minus-circle"></i><a class=active href=/posts/archive/>Archive</a>
<ul class=active>
<li><a class=active href=/posts/archive/http-logging-and-go-api-template-updates/ title="HTTP Logging and Go API Template Updates">HTTP Logging and Go API Template Updates</a></li>
<li><a href=/posts/archive/basic-redis-examples/ title="Basic Redis Examples with Go">Basic Redis Examples with Go</a></li>
<li><a href=/posts/archive/containerize-go-api/ title="Containerizing a Go API with Docker For Mac">Containerizing a Go API with Docker For Mac</a></li>
<li><a href=/posts/archive/http-json-error-responses/ title="HTTP JSON Error Responses in Go">HTTP JSON Error Responses in Go</a></li>
<li><a href=/posts/archive/king-crimson-red/ title="Drums - King Crimson Red Live @ Great Scott">Drums - King Crimson Red Live @ Great Scott</a></li>
<li><a href=/posts/archive/go-api-template/ title="Go API Template v0.0.2">Go API Template v0.0.2</a></li>
<li><a href=/posts/archive/go/ title=Go>Go</a></li>
<li><a href=/posts/archive/frankenstein/ title="Drums - Frankenstein Practice">Drums - Frankenstein Practice</a></li>
<li><a href=/posts/archive/osx-oracle-node-setup/ title="OS X Oracle + Node setup">OS X Oracle + Node setup</a></li>
<li><a href=/posts/archive/drums-raju-live/ title="Drums - Raju Live">Drums - Raju Live</a></li>
<li><a href=/posts/archive/apex-minimize/ title="Apex 5 - Minimize Left Sidebar">Apex 5 - Minimize Left Sidebar</a></li>
<li><a href=/posts/archive/raiser/ title=Raiser>Raiser</a></li>
<li>
<i class="fas fa-plus-circle"></i><a href=/posts/archive/node-oracle-glory/>Node Oracle Glory</a>
<ul>
<li><a href=/posts/archive/node-oracle-glory/volume-3/ title="Volume 3">Volume 3</a></li>
<li><a href=/posts/archive/node-oracle-glory/volume-2/ title="Volume 2">Volume 2</a></li>
<li><a href=/posts/archive/node-oracle-glory/volume-1/ title="Volume 1">Volume 1</a></li>
</ul>
</li>
<li><a href=/posts/archive/name-value-encryption/ title="Name:Value Encryption Utility using PL/SQL">Name:Value Encryption Utility using PL/SQL</a></li>
</ul>
</li>
</div>
</ul>
</div>
</div>
</div>
</section>
<section class=content-section id=content-section>
<div class=content>
<div class="container p-0 read-area">
<div class="hero-area col-sm-12" id=hero-area style=background-image:url(https://gilcrest.github.io/images/default-hero.jpg)>
</div>
<div class=page-content>
<div class="author-profile ml-auto align-self-lg-center">
<img class=rounded-circle src=/images/author/dan_hu9475e40123017607cf3e014e405fbc8c_9664_120x120_fit_q75_box.jpg alt="Author Image">
<h5 class=author-name>Dan Gillis</h5>
<p>Saturday, October 13, 2018</p>
</div>
<div class=title>
<h1>HTTP Logging and Go API Template Updates</h1>
</div>
<div class=post-content id=post-content>
<p>I built my first Go library! <a href=https://github.com/gilcrest/httplog>httplog</a> provides middleware which logs http requests and responses along with a few other features I find useful. I thought it might be helpful for some. At the very least, I tried to document the library reasonably well, spending a lot of time developing the <a href=https://github.com/gilcrest/httplog/blob/master/README.md>README</a> and ensuring the <a href=https://godoc.org/github.com/gilcrest/httplog>GoDoc</a> was in good shape. I learned a lot through this exercise.</p>
<p>I also restructured my <a href=https://github.com/gilcrest/go-API-template>Go API template repository</a> to try and shape it based on <a href="https://medium.com/u/f25c357b8e4c?source=post_page-----3afba5c9d3a6--------------------------------">Mat Ryer</a>’s fantastic “<a href=https://medium.com/statuscode/how-i-write-go-http-services-after-seven-years-37c208122831>How I write Go HTTP services after seven years</a>” post. I <em>think/hope</em> that I got the fundamentals right from the lessons he was trying to impart and have baked them into this template repo.</p>
<p>At a high level, using the template and httplog library, you can send a request that looks like this:</p>
<p><img src=/posts/archive/http-logging-and-go-api-template-updates/images/oldrequest.png alt=request></p>
<p>and get a response body that looks like this:</p>
<p><img src=/posts/archive/http-logging-and-go-api-template-updates/images/oldresponse.png alt=request></p>
<p>If turned on, the request and/or response are logged either to stdout or a PostgreSQL database (or both) and can then be used for investigative purposes, etc. You can also set options whether or not to log request/response headers and body. For instance, this example service takes password in the body, you should not log this and would turn off request body logging for this API.</p>
<p>As I mentioned above, I found the post from <a href="https://medium.com/u/f25c357b8e4c?source=post_page-----3afba5c9d3a6--------------------------------">Mat Ryer</a> to be extremely compelling and completely restructured my <a href=https://github.com/gilcrest/go-API-template>template</a>. I now have a server struct, a la:</p>
<p><img src=/posts/archive/http-logging-and-go-api-template-updates/images/struct.png alt=request></p>
<p>I have a <a href=https://github.com/gilcrest/go-API-template/blob/master/app/routes.go>routes.go</a> file where all my routing lives…</p>
<p><img src=/posts/archive/http-logging-and-go-api-template-updates/images/routes.png alt=request></p>
<p>and <a href=https://github.com/gilcrest/go-API-template/blob/master/app/handleUser.go>my handlers hang off the server</a> with request and response structs defined within the handler…</p>
<p><img src=/posts/archive/http-logging-and-go-api-template-updates/images/handler.png alt=request></p>
<p>I haven’t incorporated everything (still need to get to the testing stuff, etc.), but it’s a good start.</p>
<p>There’s a lot more happening in the <a href=https://github.com/gilcrest/go-API-template>Go API template</a> (password hashing, graceful error handling, etc.) and I plan to bake even more into it as I continue to learn. For instance, this week’s release of Go Cloud’s <a href=https://blog.golang.org/wire>Wire</a> makes me want to revisit my template again and add in dependency injection. I just added it to my list, actually….</p>
<p>Finally, I’ve been coding Go in a vacuum for a year as I don’t actually know anyone else who writes Go. I know it’s cliche, but I really do welcome feedback to help me learn. Thanks!</p>
</div>
<div class="row pl-3 pr-3">
<div class="col-md-6 share-buttons">
</div>
<div class="col-md-6 btn-improve-page">
<a href=https://github.com/gilcrest/gilcrest.github.io/edit/source/content/posts/archive/http-logging-and-go-api-template-updates/index.md title="Improve this page" target=_blank rel=noopener>
<i class="fas fa-code-branch"></i>
Improve this page
</a>
</div>
</div>
<hr>
<div class="row next-prev-navigator">
<div class="col-md-6 previous-article">
<a href=/posts/conversion/ title="Jekyll to Hugo Conversion" class="btn btn-outline-info">
<div><i class="fas fa-chevron-circle-left"></i> Prev</div>
<div class=next-prev-text>Jekyll to Hugo Conversion</div>
</a>
</div>
<div class="col-md-6 next-article">
<a href=/posts/archive/basic-redis-examples/ title="Basic Redis Examples with Go" class="btn btn-outline-info">
<div>Next <i class="fas fa-chevron-circle-right"></i></div>
<div class=next-prev-text>Basic Redis Examples with Go</div>
</a>
</div>
</div>
<hr>
<div id=disqus_thread></div>
<script type=text/javascript>(function(){var a,b;if(window.location.hostname=="localhost")return;a=document.createElement("script"),a.type="text/javascript",a.async=!0,b="dangillis",a.src="//"+b+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)})()</script>
<noscript>Please enable JavaScript to view the
<a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript>
<a href=https://disqus.com/ class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a>
</div>
</div>
</div>
<a id=scroll-to-top class=btn><i class="fas fa-chevron-circle-up"></i></a>
</section>
<section class=toc-section id=toc-section>
<div class=toc-holder>
<h5 class="text-center pl-3">Table of Contents</h5>
<hr>
<div class=toc>
<nav id=TableOfContents></nav>
</div>
</div>
</section>
</div>
<footer class="container-fluid text-center align-content-center footer pb-2">
<div class="container pt-5">
<div class="row text-left">
<div class="col-md-4 col-sm-12">
<h5>Navigation</h5>
<ul>
<li class=nav-item>
<a class=smooth-scroll href=https://gilcrest.github.io#about>About</a>
</li>
<li class=nav-item>
<a class=smooth-scroll href=https://gilcrest.github.io#recent-posts>Recent Posts</a>
</li>
</ul>
</div>
<div class="col-md-4 col-sm-12">
<h5>Contact me:</h5>
<ul>
<li><a href=mailto:dan@dangillis.dev target=_blank rel=noopener>
<span><i class="fas fa-envelope"></i></span> <span>dan@dangillis.dev</span>
</a></li>
</ul>
</div>
</div>
</div>
<hr>
<div class=container>
<div class="row text-left">
<div class=col-md-4>
<a id=theme href=https://github.com/hossainemruz/toha target=_blank rel=noopener>
<img src=/images/theme-logo_hu8376fd15465fef26ffe66b6bcf0ca686_13669_32x0_resize_box_3.png alt="Toha Theme Logo">
Toha
</a>
</div>
<div class="col-md-4 text-center">© 2021 Copyright.</div>
<div class="col-md-4 text-right">
<a id=hugo href=https://gohugo.io/ target=_blank rel=noopener>Powered by
<img src=/images/hugo-logo.svg alt="Hugo Logo" height=18>
</a>
</div>
</div>
</div>
</footer>
<script type=text/javascript src=/js/jquery-3.4.1.min.js></script>
<script type=text/javascript src=/js/popper.min.js></script>
<script type=text/javascript src=/js/bootstrap.min.js></script>
<script type=text/javascript src=/js/navbar.js></script>
<script type=text/javascript src=/js/plyr.js></script>
<script type=text/javascript src=/js/main.js></script>
<script type=text/javascript defer src=/js/katex.min.js></script>
<script type=text/javascript defer src=/js/auto-render.min.js onload=renderMathInElement(document.body)></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js></script>
<script src=/js/single.js></script>
<script>hljs.initHighlightingOnLoad()</script>
</body>
</html>